<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù†Ù‚Ø§Ø· Free Fire</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1566555811591369" crossorigin="anonymous"></script>
<style>
body { margin:0; font-family:'Tajawal', sans-serif; background:#111; color:#fff; overflow-x:hidden; }

/* Header */
header { background:linear-gradient(90deg,#c40000,#ff4d4d); padding:1em; text-align:center; font-size:1.5em; font-weight:bold; letter-spacing:1px; animation:headerGlow 2s infinite alternate; }
@keyframes headerGlow { 0% { text-shadow:0 0 5px #ff4d4d,0 0 10px #ff1a1a; } 100% { text-shadow:0 0 15px #ff4d4d,0 0 25px #ff1a1a; } }

/* Nav Buttons */
nav { display:flex; justify-content:center; gap:1em; flex-wrap:wrap; margin:1em 0; }
nav button { padding:1em 2em; border-radius:15px; font-weight:bold; font-size:1.1em; cursor:pointer; transition:transform 0.3s, box-shadow 0.3s; }
nav button:nth-child(1) { background:linear-gradient(90deg,#ff4d4d,#ff1a1a); color:#fff; box-shadow:0 0 20px #ff4d4d,0 0 40px #ff1a1a; }
nav button:nth-child(2) { background:linear-gradient(90deg,#33ccff,#3366ff); color:#fff; box-shadow:0 0 20px #33ccff,0 0 40px #3366ff; }
nav button:nth-child(3) { background:linear-gradient(90deg,#33ff77,#00cc44); color:#fff; box-shadow:0 0 20px #33ff77,0 0 40px #00cc44; }
nav button:nth-child(4) { background:linear-gradient(90deg,#ffcc33,#ff9900); color:#fff; box-shadow:0 0 20px #ffcc33,0 0 40px #ff9900; }
nav button:hover { transform:translateY(-5px) scale(1.05); }
nav button:nth-child(1):hover { box-shadow:0 0 30px #ff4d4d,0 0 60px #ff1a1a; }
nav button:nth-child(2):hover { box-shadow:0 0 30px #33ccff,0 0 60px #3366ff; }
nav button:nth-child(3):hover { box-shadow:0 0 30px #33ff77,0 0 60px #00cc44; }
nav button:nth-child(4):hover { box-shadow:0 0 30px #ffcc33,0 0 60px #ff9900; }

/* Sections */
.section { display:none; padding:1em; max-width:1000px; margin:auto; animation:fadeIn 0.5s ease forwards; }
.active { display:block; }
@keyframes fadeIn { 0% { opacity:0; transform:translateY(20px); } 100% { opacity:1; transform:translateY(0); } }

/* Video */
.video-container { position:relative; padding-bottom:56.25%; height:0; overflow:hidden; margin-top:1em; border-radius:15px; box-shadow:0 0 30px #ff4d4d,0 0 50px #ff1a1a; }
.video-container iframe { position:absolute; top:0; left:0; width:100%; height:100%; border:none; transition:transform 0.3s; }
.video-container iframe:hover { transform:scale(1.02); }

/* Titles */
#home h1 { text-align:center; font-size:2.5em; color:#ff4d4d; text-shadow:0 0 10px #ff1a1a,0 0 20px #ff4d4d; margin-top:1em; animation:glow 2s infinite alternate; }
#home p { text-align:center; font-size:1.2em; color:#fff; margin-top:0.5em; margin-bottom:1em; }
#home h3.video-title { text-align:center; color:#ffcc33; text-shadow:0 0 5px #ff9900; margin-bottom:10px; font-size:1.2em; }

@keyframes glow { 0% { text-shadow:0 0 5px #ff4d4d,0 0 10px #ff1a1a; } 100% { text-shadow:0 0 15px #ff4d4d,0 0 25px #ff1a1a; } }

.avatar { width:100px; height:100px; border-radius:50%; margin:auto; display:block; box-shadow:0 0 20px #33ccff; }

/* Ø£Ù„Ø¹Ø§Ø¨ */
.games-container { display:flex; flex-wrap:wrap; gap:1em; justify-content:center; margin-top:20px; }
.game-card { cursor:pointer; transition:transform 0.3s; text-align:center; }
.game-card:hover { transform:scale(1.05); }
.game-card img { width:150px; border-radius:10px; }
.game-card p { margin-top:5px; }

/* Responsive */
@media(max-width:600px){
  header{font-size:1.3em;padding:0.8em;} 
  nav{flex-direction:column;gap:0.5em;} 
  nav button{width:100%;} 
  iframe{height:50vh;} 
  #home h1 { font-size:2em; } 
  #home p { font-size:1em; }
  #home h3.video-title { font-size:1em; }
  .game-card img { width:120px; }
}
</style>
</head>
<body>
<header>ğŸ® Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ğŸ®</header>
<nav>
<button onclick="showSection('home')">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
<button onclick="showSection('offers')">Ø§Ù„Ø¹Ø±ÙˆØ¶</button>
<button onclick="showSection('account')">Ø­Ø³Ø§Ø¨ÙŠ</button>
<button onclick="showSection('redeem-games')">Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†</button>
</nav>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="home" class="section active">
  <h1>ğŸ® Ù†Ù‚Ø§Ø· Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ ğŸ®</h1>
  <p>Ø§ÙƒØ³Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ù† Ø®Ù„Ø§Ù„ Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ´Ø­Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ù…Ø¬Ø§Ù†Ù‹Ø§ ğŸ</p>
  <h3 class="video-title">ğŸ“¹ ÙÙŠØ¯ÙŠÙˆ Ø´Ø±Ø­ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>
  <div class="video-container">
    <iframe src="https://www.youtube.com/embed/9Hl8H3RfvrU" title="Ø´Ø±Ø­ Ù…ÙˆÙ‚Ø¹" allowfullscreen></iframe>
  </div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø¹Ø±ÙˆØ¶ -->
<div id="offers" class="section">
  <h2 style="text-align:center; color:#33ccff; text-shadow:0 0 10px #33ccff;">Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
  <div class="offers-container">
    <div>
      <h3>MyLead</h3>
      <iframe id="offerwall-mylead" src="" style="width:100%; height:500px; border:none;"></iframe>
    </div>
    <div>
      <h3>AdGem</h3>
      <iframe id="offerwall-adgem" src="" style="width:100%; height:500px; border:none;"></iframe>
    </div>
  </div>
</div>

<!-- Ù‚Ø³Ù… Ø§Ù„Ø­Ø³Ø§Ø¨ÙŠ -->
<div id="account" class="section">
  <h1 style="text-align:center; color:#ff4d4d; text-shadow:0 0 10px #ff1a1a;">ğŸ® Ø­Ø³Ø§Ø¨ÙŠ ğŸ®</h1>
  <img src="avatar.png" alt="Avatar" class="avatar">
  <div id="user-info" style="text-align:center; margin:10px 0;">Ù„Ù… ØªÙ‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯.</div>
  <button id="login-btn">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø­Ø³Ø§Ø¨ Google</button>
  <button id="logout-btn" style="display:none;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
  <p style="text-align:center;">Ø¹Ø¯Ø¯ Ù†Ù‚Ø§Ø·Ùƒ: <span id="user-points">0</span></p>
  <div style="text-align:center; margin-top:10px;">
    <input type="text" id="user-id" placeholder="Ø£Ø¯Ø®Ù„ Ø¢ÙŠØ¯ÙŠ Free Fire">
    <button id="save-id">Ø­ÙØ¸ Ø§Ù„Ø¢ÙŠØ¯ÙŠ</button>
  </div>
  <h3 style="text-align:center; margin-top:20px;">ğŸ† Ø£ÙØ¶Ù„ Ø§Ù„Ù„Ø§Ø¹Ø¨ÙŠÙ†</h3>
  <table id="leaderboard" style="width:100%; text-align:center; border-collapse:collapse;">
    <thead><tr><th>#</th><th>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</th><th>Ø§Ù„Ù†Ù‚Ø§Ø·</th></tr></thead>
    <tbody id="leaderboard-body">
      <tr><td colspan="3" style="padding:10px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯</td></tr>
    </tbody>
  </table>
</div>

<!-- Ù‚Ø³Ù… Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù† Ù„ÙƒÙ„ Ù„Ø¹Ø¨Ø© -->
<div id="redeem-games" class="section">
  <h2 style="text-align:center; color:#ffcc33;">Ø·Ù„Ø¨ Ø´Ø­Ù† Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨</h2>
  
  <!-- ØµÙˆØ± Ø§Ù„Ø£Ù„Ø¹Ø§Ø¨ -->
  <div class="games-container">
    <div class="game-card" onclick="showGameOptions('freefire')">
      <img src="https://via.placeholder.com/150/ff4d4d/ffffff?text=Free+Fire" alt="Free Fire" style="box-shadow:0 0 20px #ff4d4d;">
      <p>Free Fire</p>
    </div>
    <div class="game-card" onclick="showGameOptions('pubg')">
      <img src="https://via.placeholder.com/150/33ccff/ffffff?text=PUBG" alt="PUBG Mobile" style="box-shadow:0 0 20px #33ccff;">
      <p>PUBG Mobile</p>
    </div>
    <div class="game-card" onclick="showGameOptions('roblox')">
      <img src="https://via.placeholder.com/150/ff9900/ffffff?text=Roblox" alt="Roblox" style="box-shadow:0 0 20px #ff9900;">
      <p>Roblox</p>
    </div>
    <div class="game-card" onclick="showGameOptions('efootball')">
      <img src="https://via.placeholder.com/150/33ff77/ffffff?text=eFootball" alt="eFootball" style="box-shadow:0 0 20px #33ff77;">
      <p>eFootball</p>
    </div>
    <div class="game-card" onclick="showGameOptions('fifa')">
      <img src="https://via.placeholder.com/150/ffcc33/ffffff?text=FIFA" alt="FIFA Mobile" style="box-shadow:0 0 20px #ffcc33;">
      <p>FIFA Mobile</p>
    </div>
    <div class="game-card" onclick="showGameOptions('cod')">
      <img src="https://via.placeholder.com/150/ff1a1a/ffffff?text=COD" alt="Call of Duty" style="box-shadow:0 0 20px #ff1a1a;">
      <p>Call of Duty</p>
    </div>
    <div class="game-card" onclick="showGameOptions('clash')">
      <img src="https://via.placeholder.com/150/9933ff/ffffff?text=Clash" alt="Clash of Clans" style="box-shadow:0 0 20px #9933ff;">
      <p>Clash of Clans</p>
    </div>
  </div>
  
  <!-- Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø´Ø­Ù† ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
  <div id="game-options" style="display:none; text-align:center; margin-top:20px;">
    <h3 id="game-title" style="margin-bottom:10px;"></h3>
    <div id="options-buttons" style="display:flex; flex-wrap:wrap; gap:10px; justify-content:center;"></div>
    <button onclick="hideGameOptions()" style="margin-top:20px; padding:0.8em 1.5em; border-radius:10px; cursor:pointer; background:#ff4d4d; color:#fff;">ğŸ”™ Ø±Ø¬ÙˆØ¹</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
function showSection(id){
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    document.getElementById(id).classList.add('active');
}

const firebaseConfig = {
    apiKey: "AIzaSyBSocmPYyRrVPFQIlk8UkHWxvPNIe1B1-A",
    authDomain: "freefirerewardsdz-69572.firebaseapp.com",
    databaseURL: "https://freefirerewardsdz-69572-default-rtdb.firebaseio.com",
    projectId: "freefirerewardsdz-69572",
    storageBucket: "freefirerewardsdz-69572.appspot.com",
    messagingSenderId: "145782934523",
    appId: "1:145782934523:web:76a2f7c4d2e37f94d6595e"
};
firebase.initializeApp(firebaseConfig);
const auth=firebase.auth();
const db=firebase.database();
const myleadBaseUrl="https://reward-me.eu/3cdf5a64-64d3-11f0-aa29-8a5fb7be40ea";
const adgemBaseUrl="https://api.adgem.com/v1/wall?appid=31011&playerid=";
let currentUserUid=null;

function updateLeaderboard(){
    const leaderboardRef=db.ref('users');
    leaderboardRef.orderByChild('points').limitToLast(10).on('value',snapshot=>{
        const tbody=document.getElementById('leaderboard-body'); tbody.innerHTML='';
        if(!snapshot.exists()){ 
            tbody.innerHTML='<tr><td colspan="3" style="text-align:center; padding:10px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯</td></tr>'; 
            return; 
        }
        const users=[]; snapshot.forEach(child=>{ users.push(child.val()); });
        users.sort((a,b)=>(b.points||0)-(a.points||0));
        users.forEach((user,index)=>{
            const row=`<tr><td>${index+1}</td><td>${user.userId||'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</td><td>${user.points||0}</td></tr>`;
            tbody.innerHTML+=row;
        });
    });
}

// Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø´Ø­Ù† Ù„ÙƒÙ„ Ù„Ø¹Ø¨Ø©
const gameData = {
  freefire: [
    {price:1.05, gems:100, points:1575},
    {price:2.09, gems:210, points:3135},
    {price:5.23, gems:530, points:7845},
    {price:10.51, gems:1080, points:15765},
    {price:21.03, gems:2200, points:31545},
  ],
  pubg: [
    {price:0.99, uc:60, points:1485},
    {price:1.99, uc:120, points:2985},
    {price:4.99, uc:300, points:7485},
    {price:9.99, uc:600, points:14985},
    {price:19.99, uc:1200, points:29985},
  ],
  roblox: [
    {price:5, robux:400, points:7500},
    {price:10, robux:800, points:15000},
    {price:20, robux:1600, points:30000},
    {price:50, robux:4000, points:75000},
    {price:100, robux:8000, points:150000},
  ],
  efootball: [
    {price:4.49, coins:550, points:6735},
    {price:7.18, coins:750, points:10770},
    {price:8.97, coins:1040, points:13455},
    {price:17.95, coins:2130, points:26925},
    {price:26.92, coins:3250, points:40380},
    {price:44.87, coins:5700, points:67305},
    {price:89.74, coins:12800, points:134610},
  ],
  fifa: [
    {price:0.39, fc:40, points:585},
    {price:1.19, fc:120, points:1785},
    {price:2.99, fc:300, points:4485},
    {price:5.99, fc:600, points:8985},
    {price:11.99, fc:1200, points:17985},
    {price:29.99, fc:3000, points:44985},
    {price:59.99, fc:6000, points:89985},
    {price:99.99, fc:12000, points:149985},
  ],
  cod: [
    {price:0.99, cp:80, points:1485},
    {price:2.49, cp:200, points:3735},
    {price:6.49, cp:500, points:9735},
    {price:14.99, cp:1200, points:22485},
    {price:34.99, cp:2800, points:52485},
    {price:69.99, cp:5600, points:104985},
    {price:99.99, cp:8000, points:149985},
  ],
  clash: [
    {price:5, gems_clash:500, points:7500},
    {price:10, gems_clash:1200, points:15000},
    {price:20, gems_clash:2500, points:30000},
    {price:50, gems_clash:6500, points:75000},
    {price:100, gems_clash:14000, points:150000},
  ],
};

// Ø¹Ø±Ø¶ Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ø´Ø­Ù† Ø¹Ù†Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ ØµÙˆØ±Ø© Ø§Ù„Ù„Ø¹Ø¨Ø©
function showGameOptions(gameKey){
    const game = gameData[gameKey];
    const titleMap = {
        freefire:"Free Fire",
        pubg:"PUBG Mobile",
        roblox:"Roblox",
        efootball:"eFootball",
        fifa:"FIFA Mobile",
        cod:"Call of Duty",
        clash:"Clash of Clans"
    };
    
    const optionsContainer = document.getElementById('options-buttons');
    optionsContainer.innerHTML = ""; // ØªÙØ±ÙŠØº Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    
    game.forEach(option => {
        let pointsRequired = option.points;
        const btn = document.createElement('button');
        let quantity = option.gems || option.uc || option.robux || option.coins || option.fc || option.cp || option.gems_clash;
        let unit = option.gems ? "Ø¬ÙˆÙ‡Ø±Ø©" :
                   option.uc ? "UC" :
                   option.robux ? "Ø±ÙˆØ¨ÙˆÙƒØ³" :
                   option.coins ? "Ø¹Ù…Ù„Ø©" :
                   option.fc ? "FC" :
                   option.cp ? "CP" :
                   option.gems_clash ? "Ø¬ÙˆÙ‡Ø±Ø©" : "";

        btn.innerText = `${quantity} ${unit} - ${pointsRequired} Ù†Ù‚Ø·Ø©`;
        btn.style.padding = "0.8em 1.2em";
        btn.style.margin = "5px";
        btn.style.borderRadius = "10px";
        btn.style.cursor = "pointer";
        btn.style.background = "#ff4d4d";
        btn.style.color = "#fff";
        btn.onclick = () => redeem(pointsRequired, gameKey, option); 
        optionsContainer.appendChild(btn);
    });

    document.getElementById('game-title').innerText = "ğŸ® Ø´Ø­Ù† " + titleMap[gameKey];
    document.getElementById('game-options').style.display = "block";
}

function hideGameOptions(){
    document.getElementById('game-options').style.display = "none";
}

// Ø¯Ø§Ù„Ø© Ø´Ø­Ù† Ø§Ù„Ø¬ÙˆØ§Ù‡Ø±/Ø§Ù„Ù†Ù‚Ø§Ø· Ù…Ø¹ Ø¥Ø´Ø¹Ø§Ø± Ù…Ø¨Ø³Ø· Ù„Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
function redeem(pointsRequired, gameKey, option){
    if(!currentUserUid) return alert('âš ï¸ Ø³Ø¬Ù„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹');
    db.ref('users/'+currentUserUid).once('value').then(snap=>{
        const data = snap.val();
        if(!data) return alert('âš ï¸ Ù„Ù… ÙŠØªÙ… Ø­ÙØ¸ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø¨Ø¹Ø¯');
        if((data.points||0) < pointsRequired) return alert('âŒ Ù„ÙŠØ³ Ù„Ø¯ÙŠÙƒ Ù†Ù‚Ø§Ø· ÙƒØ§ÙÙŠØ© Ù„Ù‡Ø°Ø§ Ø§Ù„Ø´Ø­Ù†.');

        db.ref('users/'+currentUserUid).update({points: data.points - pointsRequired});

        const gameNames = {
            freefire: "Free Fire",
            pubg: "PUBG Mobile",
            roblox: "Roblox",
            efootball: "eFootball",
            fifa: "FIFA Mobile",
            cod: "Call of Duty",
            clash: "Clash of Clans"
        };

        const quantity = option.gems || option.uc || option.robux || option.coins || option.fc || option.cp || option.gems_clash;
        const unit = option.gems ? "Ø¬ÙˆÙ‡Ø±Ø©" :
                     option.uc ? "UC" :
                     option.robux ? "Ø±ÙˆØ¨ÙˆÙƒØ³" :
                     option.coins ? "Ø¹Ù…Ù„Ø©" :
                     option.fc ? "FC" :
                     option.cp ? "CP" :
                     option.gems_clash ? "Ø¬ÙˆÙ‡Ø±Ø©" : "";

        // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…
        const message = `ğŸ“© Ø·Ù„Ø¨ Ø´Ø­Ù† Ø¬Ø¯ÙŠØ¯\nğŸ® Ø§Ù„Ù„Ø¹Ø¨Ø©: ${gameNames[gameKey]}\nğŸ”¹ Ø§Ù„ÙƒÙ…ÙŠØ©: ${quantity} ${unit}\nğŸ†” Ø§Ù„Ø¢ÙŠØ¯ÙŠ: ${data.userId || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}`;

        const botToken = "8096326997:AAE_UuRKi3gnCdOfXKu76X4D4cPUuXSpPbo";
        const chatId = "6285856969";

        fetch(`https://api.telegram.org/bot${botToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}`)
          .then(() => alert('âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù† Ø¨Ù†Ø¬Ø§Ø­'))
          .catch(() => alert('âŒ ÙØ´Ù„ Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„Ø´Ø­Ù†'));
    });
}

window.addEventListener('load',()=>{
    auth.onAuthStateChanged(user=>{
        if(user){
            currentUserUid=user.uid;
            document.getElementById('user-info').innerText=`Ù…Ø±Ø­Ø¨Ù‹Ø§ ${user.displayName}`;
            document.getElementById('login-btn').style.display='none';
            document.getElementById('logout-btn').style.display='inline-block';
            document.getElementById('offerwall-mylead').src=myleadBaseUrl+"?ml_sub1="+user.uid;
            document.getElementById('offerwall-adgem').src=adgemBaseUrl+user.uid;

            const userRef=db.ref('users/'+currentUserUid);
            userRef.once('value').then(snap=>{
                if(!snap.exists()){
                    userRef.set({points:0,userId:""}).then(()=>{
                        document.getElementById('user-points').innerText="0";
                        document.getElementById('user-id').value="";
                    });
                } else {
                    const data=snap.val();
                    document.getElementById('user-points').innerText=data?.points||"0";
                    document.getElementById('user-id').value=data?.userId||"";
                }
            });

            updateLeaderboard();

        } else {
            currentUserUid=null;
            document.getElementById('user-info').innerText='Ù„Ù… ØªÙ‚Ù… Ø¨ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ø¹Ø¯';
            document.getElementById('login-btn').style.display='inline-block';
            document.getElementById('logout-btn').style.display='none';
            document.getElementById('user-points').innerText="0";
            document.getElementById('user-id').value="";
            document.getElementById('leaderboard-body').innerHTML='<tr><td colspan="3" style="text-align:center; padding:10px;">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø¨Ø¹Ø¯</td></tr>';
        }
    });

    document.getElementById('login-btn').addEventListener('click',()=>{
        const provider=new firebase.auth.GoogleAuthProvider();
        auth.signInWithPopup(provider);
    });

    document.getElementById('logout-btn').addEventListener('click',()=>{ auth.signOut(); });

    document.getElementById('save-id').addEventListener('click',()=>{
        const id=document.getElementById('user-id').value.trim();
        if(!id||!currentUserUid) return alert('ØªØ£ÙƒØ¯ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¢ÙŠØ¯ÙŠ');
        db.ref('users/'+currentUserUid).update({userId:id}).then(()=>alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¢ÙŠØ¯ÙŠ Ø¨Ù†Ø¬Ø§Ø­'));
        updateLeaderboard();
    });
});
</script>
</body>
</html>
